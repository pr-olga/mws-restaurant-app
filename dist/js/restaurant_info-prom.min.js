let restaurant;var newMap;document.addEventListener("DOMContentLoaded",()=>{initMap(),fetchRestaurantFromURL(),fetchReviewsFromURL(),fetchRestaurantFromURL2()}),initMap=(()=>{const e=getParameterByName("id");DBHelper.fetchRestaurantById(e).then((e=self.restaurant)=>(self.newMap=L.map("map",{center:[e.latlng.lat,e.latlng.lng],zoom:16,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1IjoicHItb2xnYSIsImEiOiJjaml3MmEzcDcwZjF6M2tvc2dsc2xhcW9jIn0.C3eNrk94kkZnqDbrgN4pow",maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox.streets"}).addTo(newMap),DBHelper.mapMarkerForRestaurant(e,newMap)))}),fetchRestaurantFromURL=(()=>{const e=getParameterByName("id");DBHelper.fetchRestaurantById(e).then(fillRestaurantHTML)}),fetchReviewsFromURL=(()=>{const e=getParameterByName("id");DBHelper.fetchReviews(e).then(fillReviewsHTML)}),getSubmittedReviews=(()=>{const e=getParameterByName("id");let t=document.getElementById("new-name").value,n=document.getElementById("rating").value,a=document.getElementById("new-comment").value,r={restaurant_id:parseInt(e),name:t,rating:n,comments:a};if(""===r.name||""===r.rating||""===r.comments)return event.preventDefault(),void alert("Please fill all fields in the form!");DBHelper.postReview(r)}),fillRestaurantHTML=((e=self.restaurant)=>{document.getElementById("restaurant-name").innerHTML=e.name,document.getElementById("button").innerHTML="♥",document.getElementById("restaurant-address").innerHTML=e.address;const t=document.getElementById("restaurant-img");if(t.className="restaurant-img",t.src=DBHelper.imageUrlForRestaurant(e),t.alt=DBHelper.imageAltForRestaurant(e),document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours){const t=document.getElementById("restaurant-hours"),n=e.operating_hours;for(let e in n){const a=document.createElement("tr"),r=document.createElement("td");r.innerHTML=e,a.appendChild(r);const o=document.createElement("td");o.innerHTML=n[e],a.appendChild(o),t.appendChild(a)}}}),fillReviewsHTML=((e=self.review)=>{const t=document.getElementById("reviews-container"),n=document.createElement("h3");if(n.innerHTML="Reviews",t.appendChild(n),!e){const e=document.createElement("p");return e.innerHTML="No reviews yet!",void t.appendChild(e)}const a=document.getElementById("reviews-list");e.sort((e,t)=>e.id>t.id?-1:t.id>e.id?1:0).forEach(e=>{a.appendChild(createReviewHTML(e))}),t.appendChild(a)}),createReviewHTML=(e=>{const t=document.createElement("li"),n=document.createElement("div");t.appendChild(n);const a=document.createElement("p");a.innerHTML=e.name,n.appendChild(a);const r=document.createElement("div");r.classList.add("div-content"),t.appendChild(r);const o=document.createElement("p");o.innerHTML=`RATING: ${e.rating}`,r.appendChild(o);const m=document.createElement("p");return m.innerHTML=e.comments,r.appendChild(m),t}),fetchRestaurantFromURL2=(()=>{const e=getParameterByName("id");console.log(e),DBHelper.fetchRestaurantById(e).then(fillBreadcrumb)}),fillBreadcrumb=((e=self.restaurant)=>{const t=document.getElementById("breadcrumb"),n=document.createElement("li");n.innerHTML=e.name,t.appendChild(n)}),getParameterByName=((e,t)=>{t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const n=new RegExp(`[?&]${e}(=([^&#]*)|&|#|$)`).exec(t);return n?n[2]?(console.log(t),decodeURIComponent(n[2].replace(/\+/g," "))):"":null});